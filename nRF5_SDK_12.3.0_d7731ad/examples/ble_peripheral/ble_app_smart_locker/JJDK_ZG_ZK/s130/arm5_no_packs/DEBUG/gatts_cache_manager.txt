; generated by Component: ARM Compiler 5.05 (build 41) Tool: ArmCC [4d0eb9]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\debug\gatts_cache_manager.o --asm_dir=.\DEBUG\ --list_dir=.\DEBUG\ --depend=.\debug\gatts_cache_manager.d --cpu=Cortex-M0 --apcs=interwork -O0 -I..\..\..\config -I..\..\..\..\..\..\components -I..\..\..\..\..\..\components\ble\ble_advertising -I..\..\..\..\..\..\components\ble\ble_dtm -I..\..\..\..\..\..\components\ble\ble_racp -I..\..\..\..\..\..\components\ble\ble_services\ble_ancs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_ans_c -I..\..\..\..\..\..\components\ble\ble_services\ble_bas -I..\..\..\..\..\..\components\ble\ble_services\ble_bas_c -I..\..\..\..\..\..\components\ble\ble_services\ble_cscs -I..\..\..\..\..\..\components\ble\ble_services\ble_cts_c -I..\..\..\..\..\..\components\ble\ble_services\ble_dfu -I..\..\..\..\..\..\components\ble\ble_services\ble_dis -I..\..\..\..\..\..\components\ble\ble_services\ble_gls -I..\..\..\..\..\..\components\ble\ble_services\ble_hids -I..\..\..\..\..\..\components\ble\ble_services\ble_hrs -I..\..\..\..\..\..\components\ble\ble_services\ble_hrs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_hts -I..\..\..\..\..\..\components\ble\ble_services\ble_ias -I..\..\..\..\..\..\components\ble\ble_services\ble_ias_c -I..\..\..\..\..\..\components\ble\ble_services\ble_lbs -I..\..\..\..\..\..\components\ble\ble_services\ble_lbs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_lls -I..\..\..\..\..\..\components\ble\ble_services\ble_nus -I..\..\..\..\..\..\components\ble\ble_services\ble_nus_c -I..\..\..\..\..\..\components\ble\ble_services\ble_rscs -I..\..\..\..\..\..\components\ble\ble_services\ble_rscs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_tps -I..\..\..\..\..\..\components\ble\common -I..\..\..\..\..\..\components\ble\nrf_ble_qwr -I..\..\..\..\..\..\components\ble\peer_manager -I..\..\..\..\..\..\components\boards -I..\..\..\..\..\..\components\drivers_nrf\adc -I..\..\..\..\..\..\components\drivers_nrf\clock -I..\..\..\..\..\..\components\drivers_nrf\common -I..\..\..\..\..\..\components\drivers_nrf\comp -I..\..\..\..\..\..\components\drivers_nrf\delay -I..\..\..\..\..\..\components\drivers_nrf\gpiote -I..\..\..\..\..\..\components\drivers_nrf\hal -I..\..\..\..\..\..\components\drivers_nrf\i2s -I..\..\..\..\..\..\components\drivers_nrf\lpcomp -I..\..\..\..\..\..\components\drivers_nrf\pdm -I..\..\..\..\..\..\components\drivers_nrf\power -I..\..\..\..\..\..\components\drivers_nrf\ppi -I..\..\..\..\..\..\components\drivers_nrf\pwm -I..\..\..\..\..\..\components\drivers_nrf\qdec -I..\..\..\..\..\..\components\drivers_nrf\rng -I..\..\..\..\..\..\components\drivers_nrf\rtc -I..\..\..\..\..\..\components\drivers_nrf\saadc -I..\..\..\..\..\..\components\drivers_nrf\spi_master -I..\..\..\..\..\..\components\drivers_nrf\spi_slave -I..\..\..\..\..\..\components\drivers_nrf\swi -I..\..\..\..\..\..\components\drivers_nrf\timer -I..\..\..\..\..\..\components\drivers_nrf\twi_master -I..\..\..\..\..\..\components\drivers_nrf\twis_slave -I..\..\..\..\..\..\components\drivers_nrf\uart -I..\..\..\..\..\..\components\drivers_nrf\usbd -I..\..\..\..\..\..\components\drivers_nrf\wdt -I..\..\..\..\..\..\components\libraries\bsp -I..\..\..\..\..\..\components\libraries\button -I..\..\..\..\..\..\components\libraries\crc16 -I..\..\..\..\..\..\components\libraries\crc32 -I..\..\..\..\..\..\components\libraries\csense -I..\..\..\..\..\..\components\libraries\csense_drv -I..\..\..\..\..\..\components\libraries\experimental_section_vars -I..\..\..\..\..\..\components\libraries\fds -I..\..\..\..\..\..\components\libraries\fstorage -I..\..\..\..\..\..\components\libraries\gpiote -I..\..\..\..\..\..\components\libraries\hardfault -I..\..\..\..\..\..\components\libraries\hci -I..\..\..\..\..\..\components\libraries\led_softblink -I..\..\..\..\..\..\components\libraries\log -I..\..\..\..\..\..\components\libraries\log\src -I..\..\..\..\..\..\components\libraries\low_power_pwm -I..\..\..\..\..\..\components\libraries\mem_manager -I..\..\..\..\..\..\components\libraries\pwm -I..\..\..\..\..\..\components\libraries\queue -I..\..\..\..\..\..\components\libraries\scheduler -I..\..\..\..\..\..\components\libraries\sensorsim -I..\..\..\..\..\..\components\libraries\slip -I..\..\..\..\..\..\components\libraries\timer -I..\..\..\..\..\..\components\libraries\twi -I..\..\..\..\..\..\components\libraries\uart -I..\..\..\..\..\..\components\libraries\usbd -I..\..\..\..\..\..\components\libraries\usbd\class\audio -I..\..\..\..\..\..\components\libraries\usbd\class\cdc -I..\..\..\..\..\..\components\libraries\usbd\class\cdc\acm -I..\..\..\..\..\..\components\libraries\usbd\class\hid -I..\..\..\..\..\..\components\libraries\usbd\class\hid\generic -I..\..\..\..\..\..\components\libraries\usbd\class\hid\kbd -I..\..\..\..\..\..\components\libraries\usbd\class\hid\mouse -I..\..\..\..\..\..\components\libraries\usbd\class\msc -I..\..\..\..\..\..\components\libraries\usbd\config -I..\..\..\..\..\..\components\libraries\util -I..\..\..\..\..\..\components\softdevice\common\softdevice_handler -I..\..\..\..\..\..\components\softdevice\s130\headers -I..\..\..\..\..\..\components\softdevice\s130\headers\nrf51 -I..\..\..\..\..\..\components\toolchain -I..\..\..\..\..\..\external\segger_rtt -I..\config -I..\..\..\..\..\..\components\ble\ble_services\ble_sls -ID:\development\nordic_ble\src_code\nrf51_sdk_v12_3_0\nRF5_SDK_12.3.0_d7731ad\examples\ble_peripheral\ble_app_smart_locker\JJDK_ZG_ZK\s130\arm5_no_packs\RTE -IC:\Keil_v5\ARM\PACK\ARM\CMSIS\4.2.0\CMSIS\Include -IC:\Keil_v5\ARM\PACK\NordicSemiconductor\nRF_DeviceFamilyPack\8.11.1\Device\Include -D__MICROLIB -D_RTE_ -DNRF51 -DBLE_STACK_SUPPORT_REQD -DNRF51822 -DBOARD_JJDK_ZG_ZK -DNRF_SD_BLE_API_VERSION=2 -DS130 -DNRF51 -DSOFTDEVICE_PRESENT -DSWI_DISABLE0 --omf_browse=.\debug\gatts_cache_manager.crf ..\..\..\..\..\..\components\ble\peer_manager\gatts_cache_manager.c]
                          THUMB

                          AREA ||i.evt_send||, CODE, READONLY, ALIGN=2

                  evt_send PROC
;;;84     
;;;85     static void evt_send(gscm_evt_t const * p_event)
000000  b570              PUSH     {r4-r6,lr}
;;;86     {
000002  4605              MOV      r5,r0
;;;87         for (uint32_t i = 0; i < GSCM_EVENT_HANDLERS_CNT; i++)
000004  2400              MOVS     r4,#0
000006  e005              B        |L1.20|
                  |L1.8|
;;;88         {
;;;89             m_evt_handler[i](p_event);
000008  00a0              LSLS     r0,r4,#2
00000a  4a04              LDR      r2,|L1.28|
00000c  5811              LDR      r1,[r2,r0]
00000e  4628              MOV      r0,r5
000010  4788              BLX      r1
000012  1c64              ADDS     r4,r4,#1              ;87
                  |L1.20|
000014  2c00              CMP      r4,#0                 ;87
000016  d0f7              BEQ      |L1.8|
;;;90         }
;;;91     }
000018  bd70              POP      {r4-r6,pc}
;;;92     
                          ENDP

00001a  0000              DCW      0x0000
                  |L1.28|
                          DCD      m_evt_handler

                          AREA ||i.gscm_db_change_notification_done||, CODE, READONLY, ALIGN=2

                  gscm_db_change_notification_done PROC
;;;369    
;;;370    void gscm_db_change_notification_done(pm_peer_id_t peer_id)
000000  b51c              PUSH     {r2-r4,lr}
;;;371    {
000002  4604              MOV      r4,r0
;;;372        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;373    
;;;374        // Use a uint32_t to enforce 4-byte alignment.
;;;375        static const uint32_t service_changed_pending = false;
;;;376    
;;;377        //lint -save -e65 -e64
;;;378        pm_peer_data_const_t peer_data =
000004  4904              LDR      r1,|L2.24|
000006  c903              LDM      r1,{r0,r1}
000008  9101              STR      r1,[sp,#4]
00000a  9000              STR      r0,[sp,#0]
;;;379        {
;;;380            .data_id                   = PM_PEER_DATA_ID_SERVICE_CHANGED_PENDING,
;;;381            .length_words              = PM_SC_STATE_N_WORDS(),
;;;382            .p_service_changed_pending = (bool*)&service_changed_pending,
;;;383        };
;;;384        //lint -restore
;;;385    
;;;386        // Don't need to check return code, because all error conditions can be ignored.
;;;387        //lint -save -e550
;;;388        (void) pdb_raw_store(peer_id, &peer_data, NULL);
00000c  2200              MOVS     r2,#0
00000e  4669              MOV      r1,sp
000010  4620              MOV      r0,r4
000012  f7fffffe          BL       pdb_raw_store
;;;389        //lint -restore
;;;390    }
000016  bd1c              POP      {r2-r4,pc}
;;;391    #endif // NRF_MODULE_ENABLED(PEER_MANAGER)
                          ENDP

                  |L2.24|
                          DCD      ||.constdata||+0x10

                          AREA ||i.gscm_init||, CODE, READONLY, ALIGN=2

                  gscm_init PROC
;;;164    
;;;165    ret_code_t gscm_init()
000000  b510              PUSH     {r4,lr}
;;;166    {
;;;167        NRF_PM_DEBUG_CHECK(!m_module_initialized);
;;;168    
;;;169        internal_state_reset();
000002  f7fffffe          BL       internal_state_reset
;;;170        m_module_initialized = true;
000006  2001              MOVS     r0,#1
000008  4901              LDR      r1,|L3.16|
00000a  7008              STRB     r0,[r1,#0]
;;;171    
;;;172        return NRF_SUCCESS;
00000c  2000              MOVS     r0,#0
;;;173    }
00000e  bd10              POP      {r4,pc}
;;;174    
                          ENDP

                  |L3.16|
                          DCD      m_module_initialized

                          AREA ||i.gscm_local_database_has_changed||, CODE, READONLY, ALIGN=2

                  gscm_local_database_has_changed PROC
;;;325    
;;;326    void gscm_local_database_has_changed(void)
000000  b510              PUSH     {r4,lr}
;;;327    {
;;;328        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;329        m_current_sc_store_peer_id = pdb_next_peer_id_get(PM_PEER_ID_INVALID);
000002  4804              LDR      r0,|L4.20|
000004  f7fffffe          BL       pdb_next_peer_id_get
000008  4903              LDR      r1,|L4.24|
00000a  8008              STRH     r0,[r1,#0]
;;;330        service_changed_pending_set();
00000c  f7fffffe          BL       service_changed_pending_set
;;;331    }
000010  bd10              POP      {r4,pc}
;;;332    
                          ENDP

000012  0000              DCW      0x0000
                  |L4.20|
                          DCD      0x0000ffff
                  |L4.24|
                          DCD      m_current_sc_store_peer_id

                          AREA ||i.gscm_local_db_cache_apply||, CODE, READONLY, ALIGN=2

                  gscm_local_db_cache_apply PROC
;;;241    
;;;242    ret_code_t gscm_local_db_cache_apply(uint16_t conn_handle)
000000  b5f1              PUSH     {r0,r4-r7,lr}
;;;243    {
000002  b084              SUB      sp,sp,#0x10
;;;244        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;245    
;;;246        pm_peer_id_t         peer_id = im_peer_id_get_by_conn_handle(conn_handle);
000004  9804              LDR      r0,[sp,#0x10]
000006  f7fffffe          BL       im_peer_id_get_by_conn_handle
00000a  4605              MOV      r5,r0
;;;247        ret_code_t           err_code;
;;;248        pm_peer_data_flash_t peer_data;
;;;249        uint8_t      const * p_sys_attr_data = NULL;
00000c  2600              MOVS     r6,#0
;;;250        uint16_t             sys_attr_len    = 0;
00000e  2700              MOVS     r7,#0
;;;251        uint32_t             sys_attr_flags  = (SYS_ATTR_BOTH);
000010  2003              MOVS     r0,#3
000012  9001              STR      r0,[sp,#4]
;;;252        bool                 all_attributes_applied = true;
000014  2001              MOVS     r0,#1
000016  9000              STR      r0,[sp,#0]
;;;253    
;;;254        if (peer_id != PM_PEER_ID_INVALID)
000018  481f              LDR      r0,|L5.152|
00001a  4285              CMP      r5,r0
00001c  d00d              BEQ      |L5.58|
;;;255        {
;;;256            err_code = pdb_peer_data_ptr_get(peer_id, PM_PEER_DATA_ID_GATT_LOCAL, &peer_data);
00001e  aa02              ADD      r2,sp,#8
000020  2108              MOVS     r1,#8
000022  4628              MOV      r0,r5
000024  f7fffffe          BL       pdb_peer_data_ptr_get
000028  4604              MOV      r4,r0
;;;257            if (err_code == NRF_SUCCESS)
00002a  2c00              CMP      r4,#0
00002c  d105              BNE      |L5.58|
;;;258            {
;;;259                pm_peer_data_local_gatt_db_t const * p_local_gatt_db;
;;;260    
;;;261                p_local_gatt_db = peer_data.p_local_gatt_db;
00002e  9803              LDR      r0,[sp,#0xc]
;;;262                p_sys_attr_data = p_local_gatt_db->data;
000030  1d86              ADDS     r6,r0,#6
;;;263                sys_attr_len    = p_local_gatt_db->len;
000032  8887              LDRH     r7,[r0,#4]
;;;264                sys_attr_flags  = p_local_gatt_db->flags;
000034  6801              LDR      r1,[r0,#0]
000036  9101              STR      r1,[sp,#4]
;;;265            }
000038  bf00              NOP      
                  |L5.58|
;;;266        }
;;;267    
;;;268        do
00003a  bf00              NOP      
                  |L5.60|
;;;269        {
;;;270            err_code = sd_ble_gatts_sys_attr_set(conn_handle, p_sys_attr_data, sys_attr_len, sys_attr_flags);
00003c  463a              MOV      r2,r7
00003e  4631              MOV      r1,r6
000040  9b01              LDR      r3,[sp,#4]
000042  9804              LDR      r0,[sp,#0x10]
000044  dfa9              SVC      #0xa9
000046  4604              MOV      r4,r0
;;;271    
;;;272            if (err_code == NRF_ERROR_NO_MEM)
000048  2c04              CMP      r4,#4
00004a  d101              BNE      |L5.80|
;;;273            {
;;;274                err_code = NRF_ERROR_BUSY;
00004c  2411              MOVS     r4,#0x11
00004e  e019              B        |L5.132|
                  |L5.80|
;;;275            }
;;;276            else if (err_code == NRF_ERROR_INVALID_STATE)
000050  2c08              CMP      r4,#8
000052  d101              BNE      |L5.88|
;;;277            {
;;;278                err_code = NRF_SUCCESS;
000054  2400              MOVS     r4,#0
000056  e015              B        |L5.132|
                  |L5.88|
;;;279            }
;;;280            else if (err_code == NRF_ERROR_INVALID_DATA)
000058  2c0b              CMP      r4,#0xb
00005a  d113              BNE      |L5.132|
;;;281            {
;;;282                all_attributes_applied = false;
00005c  2000              MOVS     r0,#0
00005e  9000              STR      r0,[sp,#0]
;;;283    
;;;284                if (sys_attr_flags & SYS_ATTR_USR)
000060  2102              MOVS     r1,#2
000062  9801              LDR      r0,[sp,#4]
000064  4008              ANDS     r0,r0,r1
000066  2800              CMP      r0,#0
000068  d002              BEQ      |L5.112|
;;;285                {
;;;286                    // Try setting only system attributes.
;;;287                    sys_attr_flags = SYS_ATTR_SYS;
00006a  2001              MOVS     r0,#1
00006c  9001              STR      r0,[sp,#4]
00006e  e009              B        |L5.132|
                  |L5.112|
;;;288                }
;;;289                else if (p_sys_attr_data || sys_attr_len)
000070  2e00              CMP      r6,#0
000072  d101              BNE      |L5.120|
000074  2f00              CMP      r7,#0
000076  d004              BEQ      |L5.130|
                  |L5.120|
;;;290                {
;;;291                    // Try reporting that none exist.
;;;292                    p_sys_attr_data = NULL;
000078  2600              MOVS     r6,#0
;;;293                    sys_attr_len    = 0;
00007a  2700              MOVS     r7,#0
;;;294                    sys_attr_flags  = SYS_ATTR_BOTH;
00007c  2003              MOVS     r0,#3
00007e  9001              STR      r0,[sp,#4]
000080  e000              B        |L5.132|
                  |L5.130|
;;;295                }
;;;296                else
;;;297                {
;;;298                    err_code = NRF_ERROR_INTERNAL;
000082  2403              MOVS     r4,#3
                  |L5.132|
;;;299                }
;;;300            }
;;;301        } while (err_code == NRF_ERROR_INVALID_DATA);
000084  2c0b              CMP      r4,#0xb
000086  d0d9              BEQ      |L5.60|
;;;302    
;;;303        if (!all_attributes_applied)
000088  9800              LDR      r0,[sp,#0]
00008a  2800              CMP      r0,#0
00008c  d100              BNE      |L5.144|
;;;304        {
;;;305            err_code = NRF_ERROR_INVALID_DATA;
00008e  240b              MOVS     r4,#0xb
                  |L5.144|
;;;306        }
;;;307    
;;;308        return err_code;
000090  4620              MOV      r0,r4
;;;309    }
000092  b005              ADD      sp,sp,#0x14
000094  bdf0              POP      {r4-r7,pc}
;;;310    
                          ENDP

000096  0000              DCW      0x0000
                  |L5.152|
                          DCD      0x0000ffff

                          AREA ||i.gscm_local_db_cache_set||, CODE, READONLY, ALIGN=1

                  gscm_local_db_cache_set PROC
;;;311    
;;;312    ret_code_t gscm_local_db_cache_set(pm_peer_id_t peer_id, pm_peer_data_local_gatt_db_t * p_local_db)
000000  b57c              PUSH     {r2-r6,lr}
;;;313    {
000002  4605              MOV      r5,r0
000004  460c              MOV      r4,r1
;;;314        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;315    
;;;316        pm_peer_data_const_t peer_data;
;;;317    
;;;318        memset(&peer_data, 0, sizeof(pm_peer_data_const_t));
000006  2000              MOVS     r0,#0
000008  9000              STR      r0,[sp,#0]
00000a  9001              STR      r0,[sp,#4]
;;;319        peer_data.data_id = PM_PEER_DATA_ID_GATT_LOCAL;
00000c  2008              MOVS     r0,#8
00000e  4669              MOV      r1,sp
000010  7088              STRB     r0,[r1,#2]
;;;320        peer_data.p_local_gatt_db = p_local_db;
000012  9401              STR      r4,[sp,#4]
;;;321    
;;;322        return pdb_raw_store(peer_id, &peer_data, NULL);
000014  2200              MOVS     r2,#0
000016  4628              MOV      r0,r5
000018  f7fffffe          BL       pdb_raw_store
;;;323    }
00001c  bd7c              POP      {r2-r6,pc}
;;;324    
                          ENDP


                          AREA ||i.gscm_local_db_cache_update||, CODE, READONLY, ALIGN=2

                  gscm_local_db_cache_update PROC
;;;175    
;;;176    ret_code_t gscm_local_db_cache_update(uint16_t conn_handle)
000000  b5f1              PUSH     {r0,r4-r7,lr}
;;;177    {
000002  b084              SUB      sp,sp,#0x10
;;;178        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;179    
;;;180        pm_peer_id_t peer_id = im_peer_id_get_by_conn_handle(conn_handle);
000004  9804              LDR      r0,[sp,#0x10]
000006  f7fffffe          BL       im_peer_id_get_by_conn_handle
00000a  4607              MOV      r7,r0
;;;181        ret_code_t   err_code;
;;;182    
;;;183        if (peer_id == PM_PEER_ID_INVALID)
00000c  4822              LDR      r0,|L7.152|
00000e  4287              CMP      r7,r0
000010  d102              BNE      |L7.24|
;;;184        {
;;;185            return BLE_ERROR_INVALID_CONN_HANDLE;
000012  4822              LDR      r0,|L7.156|
                  |L7.20|
;;;186        }
;;;187        else
;;;188        {
;;;189            pm_peer_data_t peer_data;
;;;190            uint16_t       n_bufs = 1;
;;;191            bool           retry_with_bigger_buffer = false;
;;;192    
;;;193            do
;;;194            {
;;;195                retry_with_bigger_buffer = false;
;;;196    
;;;197                err_code = pdb_write_buf_get(peer_id, PM_PEER_DATA_ID_GATT_LOCAL, n_bufs++, &peer_data);
;;;198                if (err_code == NRF_SUCCESS)
;;;199                {
;;;200                    pm_peer_data_local_gatt_db_t * p_local_gatt_db = peer_data.p_local_gatt_db;
;;;201    
;;;202                    p_local_gatt_db->flags = SYS_ATTR_BOTH;
;;;203    
;;;204                    err_code = sd_ble_gatts_sys_attr_get(conn_handle, &p_local_gatt_db->data[0], &p_local_gatt_db->len, p_local_gatt_db->flags);
;;;205    
;;;206                    if (err_code == NRF_SUCCESS)
;;;207                    {
;;;208                        err_code = pdb_write_buf_store(peer_id, PM_PEER_DATA_ID_GATT_LOCAL);
;;;209                    }
;;;210                    else
;;;211                    {
;;;212                        if (err_code == NRF_ERROR_DATA_SIZE)
;;;213                        {
;;;214                            // The sys attributes are bigger than the requested write buffer.
;;;215                            retry_with_bigger_buffer = true;
;;;216                        }
;;;217                        else if (err_code == NRF_ERROR_NOT_FOUND)
;;;218                        {
;;;219                            // There are no sys attributes in the GATT db, so nothing needs to be stored.
;;;220                            err_code = NRF_SUCCESS;
;;;221                        }
;;;222    
;;;223                        ret_code_t err_code_release = pdb_write_buf_release(peer_id, PM_PEER_DATA_ID_GATT_LOCAL);
;;;224                        if (err_code_release != NRF_SUCCESS)
;;;225                        {
;;;226                            err_code = NRF_ERROR_INTERNAL;
;;;227                        }
;;;228                    }
;;;229                }
;;;230                else if (err_code == NRF_ERROR_INVALID_PARAM)
;;;231                {
;;;232                    // The sys attributes are bigger than the entire write buffer.
;;;233                    err_code = NRF_ERROR_DATA_SIZE;
;;;234                }
;;;235            } while (retry_with_bigger_buffer);
;;;236        }
;;;237    
;;;238        return err_code;
;;;239    }
000014  b005              ADD      sp,sp,#0x14
000016  bdf0              POP      {r4-r7,pc}
                  |L7.24|
000018  2001              MOVS     r0,#1                 ;190
00001a  9001              STR      r0,[sp,#4]            ;190
00001c  2000              MOVS     r0,#0                 ;191
00001e  9000              STR      r0,[sp,#0]            ;191
000020  bf00              NOP                            ;193
                  |L7.34|
000022  2000              MOVS     r0,#0                 ;195
000024  9000              STR      r0,[sp,#0]            ;195
000026  9801              LDR      r0,[sp,#4]            ;197
000028  1c41              ADDS     r1,r0,#1              ;197
00002a  b289              UXTH     r1,r1                 ;197
00002c  4602              MOV      r2,r0                 ;197
00002e  ab02              ADD      r3,sp,#8              ;197
000030  9101              STR      r1,[sp,#4]            ;197
000032  2108              MOVS     r1,#8                 ;197
000034  4638              MOV      r0,r7                 ;197
000036  f7fffffe          BL       pdb_write_buf_get
00003a  4604              MOV      r4,r0                 ;197
00003c  2c00              CMP      r4,#0                 ;198
00003e  d122              BNE      |L7.134|
000040  9d03              LDR      r5,[sp,#0xc]          ;200
000042  2003              MOVS     r0,#3                 ;202
000044  6028              STR      r0,[r5,#0]            ;202
000046  1d2a              ADDS     r2,r5,#4              ;204
000048  1da9              ADDS     r1,r5,#6              ;204
00004a  682b              LDR      r3,[r5,#0]            ;204
00004c  9804              LDR      r0,[sp,#0x10]         ;204
00004e  dfaa              SVC      #0xaa                 ;204
000050  4604              MOV      r4,r0                 ;204
000052  2c00              CMP      r4,#0                 ;206
000054  d105              BNE      |L7.98|
000056  2108              MOVS     r1,#8                 ;208
000058  4638              MOV      r0,r7                 ;208
00005a  f7fffffe          BL       pdb_write_buf_store
00005e  4604              MOV      r4,r0                 ;208
000060  e010              B        |L7.132|
                  |L7.98|
000062  2c0c              CMP      r4,#0xc               ;212
000064  d102              BNE      |L7.108|
000066  2001              MOVS     r0,#1                 ;215
000068  9000              STR      r0,[sp,#0]            ;215
00006a  e002              B        |L7.114|
                  |L7.108|
00006c  2c05              CMP      r4,#5                 ;217
00006e  d100              BNE      |L7.114|
000070  2400              MOVS     r4,#0                 ;220
                  |L7.114|
000072  2108              MOVS     r1,#8                 ;223
000074  4638              MOV      r0,r7                 ;223
000076  f7fffffe          BL       pdb_write_buf_release
00007a  4606              MOV      r6,r0                 ;223
00007c  2e00              CMP      r6,#0                 ;224
00007e  d000              BEQ      |L7.130|
000080  2403              MOVS     r4,#3                 ;226
                  |L7.130|
000082  bf00              NOP                            ;228
                  |L7.132|
000084  e002              B        |L7.140|
                  |L7.134|
000086  2c07              CMP      r4,#7                 ;230
000088  d100              BNE      |L7.140|
00008a  240c              MOVS     r4,#0xc               ;233
                  |L7.140|
00008c  9800              LDR      r0,[sp,#0]            ;235
00008e  2800              CMP      r0,#0                 ;235
000090  d1c7              BNE      |L7.34|
000092  bf00              NOP                            ;236
000094  4620              MOV      r0,r4                 ;238
000096  e7bd              B        |L7.20|
;;;240    
                          ENDP

                  |L7.152|
                          DCD      0x0000ffff
                  |L7.156|
                          DCD      0x00003002

                          AREA ||i.gscm_pdb_evt_handler||, CODE, READONLY, ALIGN=2

                  gscm_pdb_evt_handler PROC
;;;132     */
;;;133    void gscm_pdb_evt_handler(pdb_evt_t const * p_event)
000000  b57f              PUSH     {r0-r6,lr}
;;;134    {
000002  4604              MOV      r4,r0
;;;135        if (p_event->evt_id == PDB_EVT_RAW_STORED)
000004  7820              LDRB     r0,[r4,#0]
000006  2801              CMP      r0,#1
000008  d117              BNE      |L8.58|
;;;136        {
;;;137            if (p_event->data_id == PM_PEER_DATA_ID_SERVICE_CHANGED_PENDING)
00000a  7920              LDRB     r0,[r4,#4]
00000c  2801              CMP      r0,#1
00000e  d114              BNE      |L8.58|
;;;138            {
;;;139                ret_code_t           err_code;
;;;140                pm_peer_data_flash_t peer_data;
;;;141    
;;;142                err_code = pdb_peer_data_ptr_get(p_event->peer_id,
000010  8860              LDRH     r0,[r4,#2]
000012  aa02              ADD      r2,sp,#8
000014  2101              MOVS     r1,#1
000016  f7fffffe          BL       pdb_peer_data_ptr_get
00001a  4605              MOV      r5,r0
;;;143                                                 PM_PEER_DATA_ID_SERVICE_CHANGED_PENDING,
;;;144                                                 &peer_data);
;;;145    
;;;146                if (err_code == NRF_SUCCESS)
00001c  2d00              CMP      r5,#0
00001e  d10b              BNE      |L8.56|
;;;147                {
;;;148                    gscm_evt_t gscm_evt;
;;;149                    gscm_evt.evt_id = GSCM_EVT_SC_STATE_STORED;
000020  2102              MOVS     r1,#2
000022  4668              MOV      r0,sp
000024  7001              STRB     r1,[r0,#0]
;;;150                    gscm_evt.peer_id = p_event->peer_id;
000026  8861              LDRH     r1,[r4,#2]
000028  8041              STRH     r1,[r0,#2]
;;;151                    gscm_evt.params.sc_state_stored.state = *peer_data.p_service_changed_pending;
00002a  9803              LDR      r0,[sp,#0xc]
00002c  7801              LDRB     r1,[r0,#0]
00002e  4668              MOV      r0,sp
000030  7101              STRB     r1,[r0,#4]
;;;152    
;;;153                    evt_send(&gscm_evt);
000032  f7fffffe          BL       evt_send
;;;154                }
000036  bf00              NOP      
                  |L8.56|
;;;155            }
000038  bf00              NOP      
                  |L8.58|
;;;156        }
;;;157    
;;;158        if (m_current_sc_store_peer_id != PM_PEER_ID_INVALID)
00003a  4804              LDR      r0,|L8.76|
00003c  8800              LDRH     r0,[r0,#0]  ; m_current_sc_store_peer_id
00003e  4904              LDR      r1,|L8.80|
000040  4288              CMP      r0,r1
000042  d001              BEQ      |L8.72|
;;;159        {
;;;160            service_changed_pending_set();
000044  f7fffffe          BL       service_changed_pending_set
                  |L8.72|
;;;161        }
;;;162    }
000048  bd7f              POP      {r0-r6,pc}
;;;163    
                          ENDP

00004a  0000              DCW      0x0000
                  |L8.76|
                          DCD      m_current_sc_store_peer_id
                  |L8.80|
                          DCD      0x0000ffff

                          AREA ||i.gscm_service_changed_ind_needed||, CODE, READONLY, ALIGN=1

                  gscm_service_changed_ind_needed PROC
;;;333    
;;;334    bool gscm_service_changed_ind_needed(uint16_t conn_handle)
000000  b57c              PUSH     {r2-r6,lr}
;;;335    {
000002  4604              MOV      r4,r0
;;;336        ret_code_t err_code;
;;;337        pm_peer_data_flash_t peer_data;
;;;338        pm_peer_id_t peer_id = im_peer_id_get_by_conn_handle(conn_handle);
000004  4620              MOV      r0,r4
000006  f7fffffe          BL       im_peer_id_get_by_conn_handle
00000a  4606              MOV      r6,r0
;;;339    
;;;340        err_code = pdb_peer_data_ptr_get(peer_id, PM_PEER_DATA_ID_SERVICE_CHANGED_PENDING, &peer_data);
00000c  466a              MOV      r2,sp
00000e  2101              MOVS     r1,#1
000010  4630              MOV      r0,r6
000012  f7fffffe          BL       pdb_peer_data_ptr_get
000016  4605              MOV      r5,r0
;;;341    
;;;342        if (err_code != NRF_SUCCESS)
000018  2d00              CMP      r5,#0
00001a  d001              BEQ      |L9.32|
;;;343        {
;;;344            return false;
00001c  2000              MOVS     r0,#0
                  |L9.30|
;;;345        }
;;;346    
;;;347        return *peer_data.p_service_changed_pending;
;;;348    }
00001e  bd7c              POP      {r2-r6,pc}
                  |L9.32|
000020  9801              LDR      r0,[sp,#4]            ;347
000022  7800              LDRB     r0,[r0,#0]            ;347
000024  e7fb              B        |L9.30|
;;;349    
                          ENDP


                          AREA ||i.gscm_service_changed_ind_send||, CODE, READONLY, ALIGN=2

                  gscm_service_changed_ind_send PROC
;;;350    
;;;351    ret_code_t gscm_service_changed_ind_send(uint16_t conn_handle)
000000  b570              PUSH     {r4-r6,lr}
;;;352    {
000002  4605              MOV      r5,r0
;;;353        static uint16_t start_handle = 0x0000;
;;;354        const  uint16_t end_handle   = 0xFFFF;
000004  4e0a              LDR      r6,|L10.48|
;;;355        ret_code_t err_code;
;;;356    
;;;357        do
000006  bf00              NOP      
                  |L10.8|
;;;358        {
;;;359            err_code = sd_ble_gatts_service_changed(conn_handle, start_handle, end_handle);
000008  4a09              LDR      r2,|L10.48|
00000a  480a              LDR      r0,|L10.52|
00000c  8801              LDRH     r1,[r0,#0]  ; start_handle
00000e  4628              MOV      r0,r5
000010  dfa7              SVC      #0xa7
000012  4604              MOV      r4,r0
;;;360            if (err_code == BLE_ERROR_INVALID_ATTR_HANDLE)
000014  4808              LDR      r0,|L10.56|
000016  4284              CMP      r4,r0
000018  d104              BNE      |L10.36|
;;;361            {
;;;362                start_handle += 1;
00001a  4806              LDR      r0,|L10.52|
00001c  8800              LDRH     r0,[r0,#0]  ; start_handle
00001e  1c40              ADDS     r0,r0,#1
000020  4904              LDR      r1,|L10.52|
000022  8008              STRH     r0,[r1,#0]
                  |L10.36|
;;;363            }
;;;364        } while (err_code == BLE_ERROR_INVALID_ATTR_HANDLE);
000024  4804              LDR      r0,|L10.56|
000026  4284              CMP      r4,r0
000028  d0ee              BEQ      |L10.8|
;;;365    
;;;366        return err_code;
00002a  4620              MOV      r0,r4
;;;367    }
00002c  bd70              POP      {r4-r6,pc}
;;;368    
                          ENDP

00002e  0000              DCW      0x0000
                  |L10.48|
                          DCD      0x0000ffff
                  |L10.52|
                          DCD      start_handle
                  |L10.56|
                          DCD      0x00003003

                          AREA ||i.internal_state_reset||, CODE, READONLY, ALIGN=2

                  internal_state_reset PROC
;;;77      */
;;;78     static void internal_state_reset()
000000  2000              MOVS     r0,#0
;;;79     {
;;;80         m_module_initialized       = false;
000002  4903              LDR      r1,|L11.16|
000004  7008              STRB     r0,[r1,#0]
;;;81         m_current_sc_store_peer_id = PM_PEER_ID_INVALID;
000006  1e40              SUBS     r0,r0,#1
000008  4902              LDR      r1,|L11.20|
00000a  8008              STRH     r0,[r1,#0]
;;;82     }
00000c  4770              BX       lr
;;;83     
                          ENDP

00000e  0000              DCW      0x0000
                  |L11.16|
                          DCD      m_module_initialized
                  |L11.20|
                          DCD      m_current_sc_store_peer_id

                          AREA ||i.service_changed_pending_set||, CODE, READONLY, ALIGN=2

                  service_changed_pending_set PROC
;;;99      */
;;;100    static void service_changed_pending_set(void)
000000  b51c              PUSH     {r2-r4,lr}
;;;101    {
;;;102        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;103    
;;;104        ret_code_t err_code;
;;;105        // Use a uint32_t to enforce 4-byte alignment.
;;;106        static const uint32_t service_changed_pending = true;
;;;107    
;;;108        //lint -save -e65 -e64
;;;109        pm_peer_data_const_t peer_data =
000002  4910              LDR      r1,|L12.68|
000004  c903              LDM      r1,{r0,r1}
000006  9101              STR      r1,[sp,#4]
000008  9000              STR      r0,[sp,#0]
;;;110        {
;;;111            .data_id                   = PM_PEER_DATA_ID_SERVICE_CHANGED_PENDING,
;;;112            .length_words              = PM_SC_STATE_N_WORDS(),
;;;113            .p_service_changed_pending = (bool*)&service_changed_pending,
;;;114        };
;;;115        //lint -restore
;;;116    
;;;117        err_code = pdb_raw_store(m_current_sc_store_peer_id, &peer_data, NULL);
00000a  2200              MOVS     r2,#0
00000c  4669              MOV      r1,sp
00000e  480e              LDR      r0,|L12.72|
000010  8800              LDRH     r0,[r0,#0]  ; m_current_sc_store_peer_id
000012  f7fffffe          BL       pdb_raw_store
000016  4604              MOV      r4,r0
;;;118        while ((m_current_sc_store_peer_id != PM_PEER_ID_INVALID) && (err_code != NRF_ERROR_BUSY))
000018  e00c              B        |L12.52|
                  |L12.26|
;;;119        {
;;;120            m_current_sc_store_peer_id = pdb_next_peer_id_get(m_current_sc_store_peer_id);
00001a  480b              LDR      r0,|L12.72|
00001c  8800              LDRH     r0,[r0,#0]  ; m_current_sc_store_peer_id
00001e  f7fffffe          BL       pdb_next_peer_id_get
000022  4909              LDR      r1,|L12.72|
000024  8008              STRH     r0,[r1,#0]
;;;121            err_code = pdb_raw_store(m_current_sc_store_peer_id, &peer_data, NULL);
000026  2200              MOVS     r2,#0
000028  4669              MOV      r1,sp
00002a  4807              LDR      r0,|L12.72|
00002c  8800              LDRH     r0,[r0,#0]  ; m_current_sc_store_peer_id
00002e  f7fffffe          BL       pdb_raw_store
000032  4604              MOV      r4,r0
                  |L12.52|
000034  4804              LDR      r0,|L12.72|
000036  8800              LDRH     r0,[r0,#0]            ;118  ; m_current_sc_store_peer_id
000038  4904              LDR      r1,|L12.76|
00003a  4288              CMP      r0,r1                 ;118
00003c  d001              BEQ      |L12.66|
00003e  2c11              CMP      r4,#0x11              ;118
000040  d1eb              BNE      |L12.26|
                  |L12.66|
;;;122        }
;;;123    }
000042  bd1c              POP      {r2-r4,pc}
;;;124    //lint -restore
                          ENDP

                  |L12.68|
                          DCD      ||.constdata||+0x4
                  |L12.72|
                          DCD      m_current_sc_store_peer_id
                  |L12.76|
                          DCD      0x0000ffff

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                  service_changed_pending
                          DCD      0x00000001
000004  0001              DCW      0x0001
000006  0100              DCB      0x01,0x00
                          DCD      service_changed_pending
                  |symbol_number.40|
                          DCD      0x00000000
000010  0001              DCW      0x0001
000012  0100              DCB      0x01,0x00
                          DCD      |symbol_number.40|

                          AREA ||.data||, DATA, ALIGN=2

                  m_evt_handler
                          DCD      gcm_gscm_evt_handler
                  m_module_initialized
000004  0000              DCB      0x00,0x00
                  m_current_sc_store_peer_id
000006  0000              DCB      0x00,0x00
                  start_handle
000008  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "..\\..\\..\\..\\..\\..\\components\\ble\\peer_manager\\gatts_cache_manager.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___21_gatts_cache_manager_c_76a3a2bf____REV16|
#line 129 "C:\\Keil_v5\\ARM\\PACK\\ARM\\CMSIS\\4.2.0\\CMSIS\\Include\\core_cmInstr.h"
|__asm___21_gatts_cache_manager_c_76a3a2bf____REV16| PROC
#line 130

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___21_gatts_cache_manager_c_76a3a2bf____REVSH|
#line 144
|__asm___21_gatts_cache_manager_c_76a3a2bf____REVSH| PROC
#line 145

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
